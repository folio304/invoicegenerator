<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Invoice Generator - Vaada and Associates</title>
  <style>
    body {
      font-family: 'Times New Roman', serif;
      margin: 40px;
      background: #f8f9fa;
    }
    .invoice {
      background: white;
      padding: 30px;
      border: 2px solid #000;
      width: 800px;
      margin: auto;
    }
    h2, h3, h4, p {
      margin: 2px 0;
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    table, th, td {
      border: 1px solid black;
    }
    th, td {
      padding: 6px;
      text-align: center;
    }
    .totals {
      margin-top: 15px;
      width: 100%;
    }
    .totals td {
      text-align: right;
      padding-right: 10px;
    }
    .signature {
      text-align: right;
      margin-top: 30px;
      font-weight: bold;
    }
    .footer {
      text-align: center;
      margin-top: 20px;
      font-style: italic;
    }
    .controls {
      text-align: center;
      margin-top: 25px;
    }
    .controls button, .controls select, .controls input {
      margin: 5px;
      padding: 8px 15px;
      font-size: 16px;
    }
    @media print {
      .controls {
        display: none;
      }
      body {
        margin: 0;
        background: white;
      }
      .invoice {
        border: none;
        width: 100%;
        margin: 0;
      }
    }
  </style>
</head>
<body>

<div class="invoice" id="invoice">
  <h2>VAADA AND ASSOCIATES</h2>
  <h4>GSTIN: AFBOA2040N1Z3</h4>
  <p>Raipur, C.G. | Contact: 7828780780</p>
  <hr>
  <table>
    <tr>
      <td><strong>Invoice No:</strong> <span id="invoiceNo"></span></td>
      <td><strong>Date:</strong> <input type="date" id="invoiceDate"></td>
    </tr>
    <tr>
      <td colspan="2"><strong>Customer Name:</strong> <input type="text" id="customerName" placeholder="Leave blank if not needed" style="width:80%"></td>
    </tr>
  </table>

  <table id="itemsTable">
    <thead>
      <tr>
        <th>S.No</th>
        <th>Item / Description</th>
        <th>Qty</th>
        <th>Rate</th>
        <th>Amount</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <table class="totals">
    <tr><td>Subtotal:</td><td id="subtotal">0.00</td></tr>
    <tr><td>CGST (<span id="cgstRate">0</span>%):</td><td id="cgst">0.00</td></tr>
    <tr><td>SGST (<span id="sgstRate">0</span>%):</td><td id="sgst">0.00</td></tr>
    <tr><td><strong>Total:</strong></td><td id="total"><strong>0.00</strong></td></tr>
  </table>

  <div class="signature">Authorised Signatory</div>
  <div class="footer">पुनः पधारें धन्यवाद !</div>
</div>

<div class="controls">
  <label>GST Rate: </label>
  <select id="gstRate">
    <option value="0">Select</option>
    <option value="5">5%</option>
    <option value="18">18%</option>
  </select>
  <button onclick="addItem()">Add Item</button>
  <button onclick="clearItems()">Clear Items</button>
  <button onclick="resetInvoice()">Reset Invoice</button>
  <button onclick="saveAndPrint()">Save / Print Invoice</button>
</div>

<script>
  let invoiceCounter = localStorage.getItem('invoiceCounter') ? parseInt(localStorage.getItem('invoiceCounter')) : 1;
  document.getElementById('invoiceNo').textContent = invoiceCounter;
  document.getElementById('invoiceDate').valueAsDate = new Date();

  const itemsTable = document.querySelector("#itemsTable tbody");
  const gstRateSelect = document.getElementById("gstRate");

  function addItem() {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${itemsTable.children.length + 1}</td>
      <td contenteditable="true"></td>
      <td contenteditable="true" oninput="calculateTotal()"></td>
      <td contenteditable="true" oninput="calculateTotal()"></td>
      <td class="amount">0.00</td>
    `;
    itemsTable.appendChild(row);
  }

  function clearItems() {
    itemsTable.innerHTML = "";
    calculateTotal();
  }

  function calculateTotal() {
    let subtotal = 0;
    document.querySelectorAll("#itemsTable tbody tr").forEach(row => {
      const qty = parseFloat(row.children[2].textContent) || 0;
      const rate = parseFloat(row.children[3].textContent) || 0;
      const amount = qty * rate;
      row.querySelector(".amount").textContent = amount.toFixed(2);
      subtotal += amount;
    });

    const gstRate = parseFloat(gstRateSelect.value) || 0;
    const cgst = subtotal * (gstRate / 2) / 100;
    const sgst = subtotal * (gstRate / 2) / 100;
    const total = subtotal + cgst + sgst;

    document.getElementById("subtotal").textContent = subtotal.toFixed(2);
    document.getElementById("cgst").textContent = cgst.toFixed(2);
    document.getElementById("sgst").textContent = sgst.toFixed(2);
    document.getElementById("total").textContent = total.toFixed(2);
    document.getElementById("cgstRate").textContent = (gstRate / 2).toFixed(1);
    document.getElementById("sgstRate").textContent = (gstRate / 2).toFixed(1);
  }

  gstRateSelect.addEventListener("change", calculateTotal);

  function resetInvoice() {
    document.getElementById("customerName").value = "";
    itemsTable.innerHTML = "";
    gstRateSelect.value = "0";
    calculateTotal();
  }

  function saveAndPrint() {
    window.print();
    // After printing, increment invoice number and reset form
    invoiceCounter++;
    localStorage.setItem('invoiceCounter', invoiceCounter);
    document.getElementById('invoiceNo').textContent = invoiceCounter;
    resetInvoice();
  }
</script>

</body>
</html>